<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script type=application/javascript src=https://stephenc.github.io/js/theme-mode.js></script><link rel=stylesheet href=https://stephenc.github.io/css/frameworks.min.css><link rel=stylesheet href=https://stephenc.github.io/css/github.min.css><link rel=stylesheet href=https://stephenc.github.io/css/github-style.css><link rel=stylesheet href=https://stephenc.github.io/css/light.css><link rel=stylesheet href=https://stephenc.github.io/css/dark.css><link rel=stylesheet href=https://stephenc.github.io/css/syntax.css><title>Posts - Stephen's technical blog</title><link rel=icon type=image/x-icon href=https://stephenc.github.io/images/favicon.ico><meta name=theme-color content="#1e2327"><meta name=description content><meta name=keywords content='blog'><meta name=robots content="noodp"><link rel=canonical href=https://stephenc.github.io/post/><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts - Stephen's technical blog"><meta name=twitter:description content><meta name=twitter:site content="https://stephenc.github.io/"><meta name=twitter:creator content><meta name=twitter:image content="https://stephenc.github.io/"><meta property="og:type" content="website"><meta property="og:title" content="Posts - Stephen's technical blog"><meta property="og:description" content><meta property="og:url" content="https://stephenc.github.io/post/"><meta property="og:site_name" content="Posts"><meta property="og:image" content="https://stephenc.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/post/index.xml rel=alternate type=application/rss+xml title="Stephen's technical blog"></head><body><div style=position:relative><header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"><div class="Header-item mobile-none" style=margin-top:-4px;margin-bottom:-4px><a class=Header-link href=https://stephenc.github.io/><img class=octicon height=32 width=32 src=/images/top-icon.png></a></div><div class="Header-item d-md-none"><button class="Header-link btn-link js-details-target" type=button onclick='document.querySelector("#header-search").style.display=document.querySelector("#header-search").style.display=="none"?"block":"none"'>
<svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button></div><div style=display:none id=header-search class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"><div class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"><div class=position-relative><form target=_blank id=search-form accept-charset=UTF-8 method=get autocomplete=off><label class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"><input type=text class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" name=q placeholder=Search autocomplete=off></label></form></div></div></div><div class="Header-item Header-item--full flex-justify-center d-md-none position-relative"><a class=Header-link href=https://stephenc.github.io/><img class="octicon octicon-mark-github v-align-middle" height=32 width=32 src=/images/top-icon.png></a></div><div class=Header-item style=margin-right:0><a href=javascript:void(0) class="Header-link no-select" onclick=switchTheme()><svg style="fill:var(--color-profile-color-modes-toggle-moon)" class="no-select" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754c3.05612.0 5.53362-2.47748 5.53362-5.5336C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961 9.95801 1.07727 10.3495.771159 10.6474.99992c1.4679 1.12724 2.4141 2.90007 2.4141 4.89391.0 3.40575-2.7609 6.16667-6.16665 6.16667-2.94151.0-5.40199-2.0595-6.018122-4.81523C.794841 6.87902 1.23668 6.65289 1.55321 6.85451 2.41106 7.40095 3.4296 7.71754 4.52208 7.71754z"/></svg></a></div></header></div><div id=search-result class="container-lg px-3 new-discussion-timeline" style=display:none></div><div class=application-main><div class="mt-4 position-sticky top-0 d-none d-md-block bg-white width-full border-bottom color-border-secondary" style=z-index:3><div class="container-xl px-3 px-md-4 px-lg-5"><div class="gutter-condensed gutter-lg flex-column flex-md-row d-flex"><div class="flex-shrink-0 col-12 col-md-3 mb-4 mb-md-0"></div><div class="flex-shrink-0 col-12 col-md-9 mb-4 mb-md-0"><div class="UnderlineNav width-full box-shadow-none hx_UnderlineNav-with-profile-color-modes-banner"><nav class=UnderlineNav-body><a class=UnderlineNav-item href=https://stephenc.github.io/><svg class="octicon octicon-book UnderlineNav-octicon hide-sm" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M0 1.75A.75.75.0 01.75 1h4.253c1.227.0 2.317.59 3 1.501A3.744 3.744.0 0111.006 1h4.245a.75.75.0 01.75.75v10.5a.75.75.0 01-.75.75h-4.507a2.25 2.25.0 00-1.591.659l-.622.621a.75.75.0 01-1.06.0l-.622-.621A2.25 2.25.0 005.258 13H.75A.75.75.0 010 12.25V1.75zm8.755 3a2.25 2.25.0 012.25-2.25H14.5v9h-3.757c-.71.0-1.4.201-1.992.572l.004-7.322zm-1.504 7.324.004-5.073-.002-2.253A2.25 2.25.0 005.003 2.5H1.5v9h3.757a3.75 3.75.0 011.994.574z"/></svg>
Overview
</a><a class="UnderlineNav-item selected" href=https://stephenc.github.io/post><svg class="octicon octicon-repo UnderlineNav-octicon hide-sm" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M2 2.5A2.5 2.5.0 014.5.0h8.75a.75.75.0 01.75.75v12.5a.75.75.0 01-.75.75h-2.5a.75.75.0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75.0 01-1.072 1.05A2.495 2.495.0 012 11.5v-9zm10.5-1V9h-8c-.356.0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25.0 00.4.2l1.45-1.087a.25.25.0 01.3.0L8.6 15.7a.25.25.0 00.4-.2v-3.25A.25.25.0 008.75 12h-3.5a.25.25.0 00-.25.25z"/></svg>
Posts
<span class=Counter>67</span></a></nav><div class="profile-color-modes js-promo-color-modes-banner-profile isInitialToggle"><svg width="106" height="60" viewBox="0 0 106 60" fill="none" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><g class="profile-color-modes-illu-group profile-color-modes-illu-red"><path d="M37.5 58.5v-1c0-7.732 6.268-14 14-14v0c7.732.0 14 6.268 14 14v1"/></g><g class="profile-color-modes-illu-group profile-color-modes-illu-orange"><path d="M104.07 58.5C103.401 55.092 97.7635 54.3869 95.5375 57.489 97.4039 54.6411 99.7685 48.8845 94.6889 46.6592 89.4817 44.378 86.1428 50.1604 85.3786 54.1158 85.9519 50.4768 83.7226 43.294 78.219 44.6737 72.7154 46.0534 72.7793 51.3754 74.4992 55.489 74.169 54.7601 72.4917 53.3567 70.5 52.8196"/></g><g class="profile-color-modes-illu-group profile-color-modes-illu-purple"><path d="M5.51109 58.5v-6c0-11.0457 8.95431-20 20.00001-20 5.9734.0 11.3353 2.6188 15 6.7709C40.7212 39.5089 40.9258 39.7521 41.1245 40"/><path d="M27.511 49.5c2.1667.0 1.4.0 5 0"/><path d="M27.511 56.5c2.1666.0-.599999999999998.0 3 0"/></g><g class="profile-color-modes-illu-group profile-color-modes-illu-green"><circle cx="5.5" cy="12.5" r="4"/><circle cx="18.5" cy="5.5" r="4"/><path d="M18.5 9.5v18"/><path d="M18.5 23.5C6 23.5 5.5 23.6064 5.5 16.5"/></g><g class="profile-color-modes-illu-group profile-color-modes-illu-blue"><g class="profile-color-modes-illu-frame"><path d="M40.6983 31.5C40.5387 29.6246 40.6456 28.0199 41.1762 27.2317 42.9939 24.5312 49.7417 26.6027 52.5428 30.2409 54.2551 29.8552 56.0796 29.6619 57.9731 29.6619 59.8169 29.6619 61.5953 29.8452 63.2682 30.211 66.0833 26.5913 72.799 24.5386 74.6117 27.2317 75.6839 28.8246 75.0259 33.7525 73.9345 37.5094 74.2013 37.9848 74.4422 38.4817 74.6555 39"/></g><g class="profile-color-modes-illu-frame"><path d="M41.508 31.5C41.6336 31.2259 41.7672 30.9582 41.9085 30.6968 40.7845 26.9182 40.086 21.8512 41.1762 20.2317 42.9939 17.5312 49.7417 19.6027 52.5428 23.2409 54.2551 22.8552 56.0796 22.6619 57.9731 22.6619 59.8169 22.6619 61.5953 22.8452 63.2682 23.211 66.0833 19.5913 72.799 17.5386 74.6117 20.2317 75.6839 21.8246 75.0259 26.7525 73.9345 30.5094 75.1352 32.6488 75.811 35.2229 75.811 38.2283 75.811 38.49 75.8058 38.7472 75.7957 39"/><path d="M49.4996 33v2.6757"/><path d="M67.3375 33v2.6757"/></g><g class="profile-color-modes-illu-frame"><path d="M41.508 31.5C41.6336 31.2259 41.7672 30.9582 41.9085 30.6968 40.7845 26.9182 40.086 21.8512 41.1762 20.2317 42.9939 17.5312 49.7417 19.6027 52.5428 23.2409 54.2551 22.8552 56.0796 22.6619 57.9731 22.6619 59.8169 22.6619 61.5953 22.8452 63.2682 23.211 66.0833 19.5913 72.799 17.5386 74.6117 20.2317 75.6839 21.8246 75.0259 26.7525 73.9345 30.5094 75.1352 32.6488 75.811 35.2229 75.811 38.2283 75.811 38.49 75.8058 38.7472 75.7957 39"/></g><g class="profile-color-modes-illu-frame"><path d="M41.508 31.5C41.6336 31.2259 41.7672 30.9582 41.9085 30.6968 40.7845 26.9182 40.086 21.8512 41.1762 20.2317 42.9939 17.5312 49.7417 19.6027 52.5428 23.2409 54.2551 22.8552 56.0796 22.6619 57.9731 22.6619 59.8169 22.6619 61.5953 22.8452 63.2682 23.211 66.0833 19.5913 72.799 17.5386 74.6117 20.2317 75.6839 21.8246 75.0259 26.7525 73.9345 30.5094 75.1352 32.6488 75.811 35.2229 75.811 38.2283 75.811 38.49 75.8058 38.7472 75.7957 39"/><path d="M49.4996 33v2.6757"/><path d="M67.3375 33v2.6757"/></g><g class="profile-color-modes-illu-frame"><path d="M41.508 31.5C41.6336 31.2259 41.7672 30.9582 41.9085 30.6968 40.7845 26.9182 40.086 21.8512 41.1762 20.2317 42.9939 17.5312 49.7417 19.6027 52.5428 23.2409 54.2551 22.8552 56.0796 22.6619 57.9731 22.6619 59.8169 22.6619 61.5953 22.8452 63.2682 23.211 66.0833 19.5913 72.799 17.5386 74.6117 20.2317 75.6839 21.8246 75.0259 26.7525 73.9345 30.5094 75.1352 32.6488 75.811 35.2229 75.811 38.2283 75.811 38.49 75.8058 38.7472 75.7957 39"/></g><g class="profile-color-modes-illu-frame"><path d="M41.508 31.5C41.6336 31.2259 41.7672 30.9582 41.9085 30.6968 40.7845 26.9182 40.086 21.8512 41.1762 20.2317 42.9939 17.5312 49.7417 19.6027 52.5428 23.2409 54.2551 22.8552 56.0796 22.6619 57.9731 22.6619 59.8169 22.6619 61.5953 22.8452 63.2682 23.211 66.0833 19.5913 72.799 17.5386 74.6117 20.2317 75.6839 21.8246 75.0259 26.7525 73.9345 30.5094 75.1352 32.6488 75.811 35.2229 75.811 38.2283 75.811 38.49 75.8058 38.7472 75.7957 39"/><path d="M49.4996 33v2.6757"/><path d="M67.3375 33v2.6757"/></g><g class="profile-color-modes-illu-frame"><path d="M73.4999 40.2236c1.471-2.0187 2.3109-4.6445 2.3109-7.9953.0-3.0054-.675700000000006-5.5795-1.8764-7.7189C75.0258 20.7525 75.6838 15.8246 74.6116 14.2317 72.7989 11.5386 66.0832 13.5913 63.2681 17.211 61.5952 16.8452 59.8167 16.6619 57.973 16.6619 56.0795 16.6619 54.2549 16.8552 52.5427 17.2409 49.7416 13.6027 42.9938 11.5312 41.176 14.2317 40.0859 15.8512 40.7843 20.9182 41.9084 24.6968c-.9054 1.6748-1.4938 3.6097-1.6955 5.8032"/><path d="M82.9458 30.5471 76.8413 31.657"/><path d="M76.2867 34.4319 81.8362 37.7616"/><path d="M49.4995 27.8242v2.6757"/><path d="M67.3374 27.8242v2.6756"/></g><g class="profile-color-modes-illu-frame"><path d="M45.3697 34.2658c-3.482-2.1282-5.6584-5.6436-5.6584-11.0375.0-2.9182.637000000000001-5.4297 1.7732-7.5315C40.3605 11.9182 39.662 6.85125 40.7522 5.23168c1.8177-2.70051 8.5655-.62898 11.3666 3.00927 1.7122-.38574 3.5368-.57909 5.4303-.57909C59.3929 7.66186 61.1713 7.84519 62.8442 8.21095 65.6593 4.59134 72.375 2.5386 74.1877 5.23168 75.2599 6.82461 74.6019 11.7525 73.5105 15.5094 74.7112 17.6488 75.3869 20.2229 75.3869 23.2283c0 5.3939-2.1764 8.9093-5.6584 11.0375 1.1318 1.2705 2.8772 4.0898 3.5791 5.7342"/><path d="M49.0747 19.8242v2.6757"/><path d="M54.0991 28C54.6651 29.0893 55.7863 30.0812 57.9929 30.0812 59.0642 30.0812 59.8797 29.8461 60.5 29.4788"/><path d="M66.9126 19.8242v2.6757"/><path d="M33.2533 20.0237l5.819 2.153"/><path d="M39.1369 25.0058l-6.0434 2.3154"/><path d="M81.8442 19.022l-5.819 2.1531"/><path d="M75.961 24.0041 82.0045 26.3196"/></g><g class="profile-color-modes-illu-frame"><path d="M73.4999 40.2236c1.471-2.0187 2.3109-4.6445 2.3109-7.9953.0-3.0054-.675700000000006-5.5795-1.8764-7.7189C75.0258 20.7525 75.6838 15.8246 74.6116 14.2317 72.7989 11.5386 66.0832 13.5913 63.2681 17.211 61.5952 16.8452 59.8167 16.6619 57.973 16.6619 56.0795 16.6619 54.2549 16.8552 52.5427 17.2409 49.7416 13.6027 42.9938 11.5312 41.176 14.2317 40.0859 15.8512 40.7843 20.9182 41.9084 24.6968c-.9054 1.6748-1.4938 3.6097-1.6955 5.8032"/><path d="M82.9458 30.5471 76.8413 31.657"/><path d="M76.2867 34.4319 81.8362 37.7616"/><path d="M49.4995 27.8242v2.6757"/><path d="M67.3374 27.8242v2.6756"/></g><g class="profile-color-modes-illu-frame"><path d="M40.6983 31.5C40.5387 29.6246 40.6456 28.0199 41.1762 27.2317 42.9939 24.5312 49.7417 26.6027 52.5428 30.2409 54.2551 29.8552 56.0796 29.6619 57.9731 29.6619 59.8169 29.6619 61.5953 29.8452 63.2682 30.211 66.0833 26.5913 72.799 24.5386 74.6117 27.2317 75.6839 28.8246 75.0259 33.7525 73.9345 37.5094 74.2013 37.9848 74.4422 38.4817 74.6555 39"/></g></g></svg>
<span class="profile-color-modes-toggle js-promo-color-modes-toggle no-select" tabindex=0 onclick=switchTheme()><div class="profile-color-modes-toggle-track no-select"></div><div class="profile-color-modes-toggle-thumb js-promo-color-modes-thumb"><svg style="fill:var(--color-profile-color-modes-toggle-moon);margin:7px 0 0 7px" width="14" height="13" viewBox="0 0 14 13"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754c3.05612.0 5.53362-2.47748 5.53362-5.5336C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961 9.95801 1.07727 10.3495.771159 10.6474.99992c1.4679 1.12724 2.4141 2.90007 2.4141 4.89391.0 3.40575-2.7609 6.16667-6.16665 6.16667-2.94151.0-5.40199-2.0595-6.018122-4.81523C.794841 6.87902 1.23668 6.65289 1.55321 6.85451 2.41106 7.40095 3.4296 7.71754 4.52208 7.71754z"/></svg></div></span></div></div></div></div></div></div><div class="container-xl px-3 px-md-4 px-lg-5"><div class="gutter-condensed gutter-lg flex-column flex-md-row d-flex"><div class="flex-shrink-0 col-12 col-md-3 mb-4 mb-md-0"><div class="h-card mt-md-n5" style=margin-top:24px><div class="user-profile-sticky-bar js-user-profile-sticky-bar d-none d-md-block" id=headerStuck><div class="user-profile-mini-vcard d-table"><span class="user-profile-mini-avatar d-table-cell v-align-middle lh-condensed-ultra pr-2"><img class="rounded-1 avatar-user" height=32 width=32 src=/images/avatar.jpg>
</span><span class="d-table-cell v-align-middle lh-condensed"><strong>Stephen Connolly</strong></span></div></div><div class="clearfix d-flex d-md-block flex-items-center mb-4 mb-md-0"><div class="position-relative d-inline-block col-2 col-md-12 mr-3 mr-md-0 flex-shrink-0" style=z-index:4><a href=/images/avatar.jpg><img style=height:auto alt=Avatar width=260 height=260 id=headerImg class="avatar avatar-user width-full border bg-white" src=/images/avatar.jpg></a><div class="user-status-container position-relative hide-sm hide-md"><div class="f5 user-status-circle-badge-container"><div class="user-status-circle-badge d-inline-block lh-condensed-ultra p-2"><div class="d-flex flex-items-center flex-items-stretch"><div class="f6 lh-condensed user-status-header d-inline-flex user-status-emoji-only-header circle"><div class="user-status-emoji-container flex-shrink-0 mr-2 d-flex flex-items-center flex-justify-center"><div><g-emoji class=g-emoji>üòÄ</g-emoji></div></div></div></div></div></div></div></div><div class="vcard-names-container float-left col-10 col-md-12 pt-1 pt-md-3 pb-1 pb-md-3 js-sticky js-user-profile-sticky-fields" data-original-top=0px style=position:sticky><h1 class="vcard-names pl-2 pl-md-0"><span class="p-name vcard-fullname d-block overflow-hidden">Stephen Connolly</span>
<span class="p-nickname vcard-username d-block">stephenc</span></h1></div></div><div class="p-note user-profile-bio mb-3 js-user-profile-bio f4"><div>Longer form musings</div></div><div class="d-flex flex-column"><div class="js-profile-editable-area d-flex flex-column d-md-block"><ul class=vcard-details><li class="vcard-detail pt-1 css-truncate css-truncate-target hide-sm hide-md"><svg class="octicon octicon-location" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M11.536 3.464a5 5 0 010 7.072L8 14.07l-3.536-3.535a5 5 0 117.072-7.072v.001zm1.06 8.132a6.5 6.5.0 10-9.192.0l3.535 3.536a1.5 1.5.0 002.122.0l3.535-3.536zM8 9a2 2 0 100-4 2 2 0 000 4z"/></svg>
<span class=p-label>Ireland</span></li><li class="vcard-detail pt-1 css-truncate css-truncate-target"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75.0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83.0.75.75.0 00-1.06 1.06 3.5 3.5.0 004.95.0l2.5-2.5a3.5 3.5.0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83.0.75.75.0 001.06-1.06 3.5 3.5.0 00-4.95.0l-2.5 2.5a3.5 3.5.0 004.95 4.95l1.25-1.25a.75.75.0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83.0z"/></svg>
<a rel="nofollow me" class=link-gray-dark href=https://stephenc.github.io/>https://stephenc.github.io/</a></li></ul></div></div><div class="border-top color-border-secondary pt-3 mt-3 clearfix hide-sm hide-md"><h2 class="mb-2 h4">Organizations</h2><div style=display:flex;justify-content:flex-start;flex-wrap:wrap;margin-bottom:3px><a style="margin:0 10px 10px 0" href=https://github.com/stephenc><svg id="github-icon" viewBox="0 0 16 16" width="32" height="32" fill="#24292e"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
</a><a style="margin:0 10px 10px 0" href=https://linkedin.com/in/stephenalanconnolly><img alt=@linkedin width=32 height=32 src=https://stephenc.github.io/images/linkedin.png class=avatar>
</a><a style="margin:0 10px 10px 0" href=https://stephenc.github.io/index.xml><img alt=@rss width=32 height=32 src=https://stephenc.github.io/images/rss.png class=avatar></a></div></div></div></div><div class="flex-shrink-0 col-12 col-md-9 mb-4 mb-md-0"><div class="UnderlineNav user-profile-nav d-block d-md-none position-sticky top-0 pl-3 ml-n3 mr-n3 pr-3 bg-white" style=z-index:3><nav class=UnderlineNav-body><a class=UnderlineNav-item href=https://stephenc.github.io/><svg class="octicon octicon-book UnderlineNav-octicon hide-sm" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M0 1.75A.75.75.0 01.75 1h4.253c1.227.0 2.317.59 3 1.501A3.744 3.744.0 0111.006 1h4.245a.75.75.0 01.75.75v10.5a.75.75.0 01-.75.75h-4.507a2.25 2.25.0 00-1.591.659l-.622.621a.75.75.0 01-1.06.0l-.622-.621A2.25 2.25.0 005.258 13H.75A.75.75.0 010 12.25V1.75zm8.755 3a2.25 2.25.0 012.25-2.25H14.5v9h-3.757c-.71.0-1.4.201-1.992.572l.004-7.322zm-1.504 7.324.004-5.073-.002-2.253A2.25 2.25.0 005.003 2.5H1.5v9h3.757a3.75 3.75.0 011.994.574z"/></svg>
Overview
</a><a class='UnderlineNav-item selected' href=https://stephenc.github.io/post><svg class="octicon octicon-repo UnderlineNav-octicon hide-sm" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M2 2.5A2.5 2.5.0 014.5.0h8.75a.75.75.0 01.75.75v12.5a.75.75.0 01-.75.75h-2.5a.75.75.0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75.0 01-1.072 1.05A2.495 2.495.0 012 11.5v-9zm10.5-1V9h-8c-.356.0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25.0 00.4.2l1.45-1.087a.25.25.0 01.3.0L8.6 15.7a.25.25.0 00.4-.2v-3.25A.25.25.0 008.75 12h-3.5a.25.25.0 00-.25.25z"/></svg>
Posts
<span class=Counter>67</span></a></nav></div><div><div class=position-relative><div><style>.tags{padding:15px 0}</style><div class="f6 text-gray mt-2 tags border-bottom"><a class="muted-link mr-3" href=/categories/infrastructure/><svg class="octicon octicon-package" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M8.878.392a1.75 1.75.0 00-1.756.0l-5.25 3.045A1.75 1.75.0 001 4.951v6.098c0 .624.332 1.2.872 1.514l5.25 3.045a1.75 1.75.0 001.756.0l5.25-3.045c.54-.313.872-.89.872-1.514V4.951c0-.624-.332-1.2-.872-1.514L8.878.392zM7.875 1.69a.25.25.0 01.25.0l4.63 2.685L8 7.133 3.245 4.375l4.63-2.685zM2.5 5.677v5.372c0 .09.047.171.125.216l4.625 2.683V8.432L2.5 5.677zm6.25 8.271 4.625-2.683a.25.25.0 00.125-.216V5.677L8.75 8.432v5.516z"/></svg>
infrastructure
</a><a class="muted-link mr-3" href=/categories/kubernetes/><svg class="octicon octicon-package" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M8.878.392a1.75 1.75.0 00-1.756.0l-5.25 3.045A1.75 1.75.0 001 4.951v6.098c0 .624.332 1.2.872 1.514l5.25 3.045a1.75 1.75.0 001.756.0l5.25-3.045c.54-.313.872-.89.872-1.514V4.951c0-.624-.332-1.2-.872-1.514L8.878.392zM7.875 1.69a.25.25.0 01.25.0l4.63 2.685L8 7.133 3.245 4.375l4.63-2.685zM2.5 5.677v5.372c0 .09.047.171.125.216l4.625 2.683V8.432L2.5 5.677zm6.25 8.271 4.625-2.683a.25.25.0 00.125-.216V5.677L8.75 8.432v5.516z"/></svg>
kubernetes
</a><a class="muted-link mr-3" href=/tags/cloudbees/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
cloudbees
</a><a class="muted-link mr-3" href=/tags/devops/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
devops
</a><a class="muted-link mr-3" href=/tags/general/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
general
</a><a class="muted-link mr-3" href=/tags/java/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
java
</a><a class="muted-link mr-3" href=/tags/javaee/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
javaee
</a><a class="muted-link mr-3" href=/tags/jenkins/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
jenkins
</a><a class="muted-link mr-3" href=/tags/kubernetes/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
kubernetes
</a><a class="muted-link mr-3" href=/tags/maven/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
maven
</a><a class="muted-link mr-3" href=/tags/operator-pattern/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
operator-pattern
</a><a class="muted-link mr-3" href=/tags/platform-engineering/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
platform-engineering
</a><a class="muted-link mr-3" href=/tags/shell/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
shell
</a><a class="muted-link mr-3" href=/tags/vault/><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
vault</a></div><ul><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2008-04-01-more-praise-for-hudson/>More praise for Hudson</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>Over on the Maven2 Users list a recent poster asked what CI server was best, and Hudson was the only answer.Then Jason van Zyl posted this praise for Hudson:I know from my vantage point Hudson is the only system I will provide commercial support for at Sonatype because the battle is over. Hudson won by making developers lives&rsquo; easier. Kohsuke will go to no end to make things easier for users. &mldr;At any rate I guarantee you that inside 3 months Hudson will have the best Maven integration of any CI/Build Server there is.I&rsquo;m personally biased towards Hudson, but I have to agree that it has won the war of the CI servers. I don&rsquo;t see anything coming close in ease of use or speed of startup.</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Tue, 01 Apr 2008 00:00:00 +0000" class=no-wrap title=" Tue, 01 Apr 2008 00:00:00 +0000">Tue, 01 Apr 2008 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2008-04-01-writing-a-hudson-plugin-part-6-parsing-the-results/>Writing a Hudson plugin (Part 6 - Parsing the results)</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>In some ways parsing the JavaNCSS results is the least interesting part of developing a Hudson plugin, as once I have implemented the parser, it is available for everyone. For that reason I will focus more on:best practice techniques for parsing resultscommon gotchasdesigning for extensionGetting startedFirst off, we need to analyse the results file format. In the case of JavaNCSS there are multiple ways that the results file can be generated: from the JavaNCSS program directly, from ANT or from Maven. This leads us onto gotcha #1Gotcha #1:Never assume that a build tool generates the same format of output when run from the command line, ANT or Maven.A case in point for Gotcha #1 is Findbugs which generates one XML format from the command line and ANT, and generates a different format that appears similar at first glance when run from Maven (mail thread). In this case it turns out that Maven 1 used the different format output, and it is feared that some people came to depend on this Maven 1 format, so when the plugin for Maven 2 was developed, they kept the Maven 1 format. In any case, the moral is don‚Äôt assume, check!So we use the sample projects from Part 1 and generate an ANT and a Maven 2 XML report. First off, here is the report from ANT:2008-04-1211:22:30 com.onedash.common 1 3 10 3 &lt;javadoc_lines>12&lt;/javadoc_lines> &lt;single_comment_lines>0&lt;/single_comment_lines> &lt;multi_comment_lines>0&lt;/multi_comment_lines> &mldr; &mldr; 5 8 46 9 &lt;javadoc_lines>37&lt;/javadoc_lines> &lt;single_comment_lines>0&lt;/single_comment_lines> &lt;multi_comment_lines>0&lt;/multi_comment_lines> PackagesClassesFunctionsNCSSJavadocsper 4.005.008.0046.009.00Project 1.252.0011.502.25Package 1.609.201.80Class 5.751.13Function com.onedash.common.Factory 7 3 0 3 &mldr; &mldr; 6.60 1.60 0.00 1.80 46.00 com.onedash.common.Factory.Factory() 1 1 1 &mldr; &mldr; 46.00OK, first off, for those following the tutorial exactly, I have cheated a little. I added some more source files into the project to make sure that I have multiple classes is different packages. You can see the source code I built from here. Additionally, I have trimmed the output somewhat to highlight the interesting bits, removing the duplicate entries.From this report file we can see a basic XML structure:The root element is and has child elements: , , , , and The and elements are the timestamp when the report was generated with the date in YYYY-MM-DD format and the time in HH:MM:SS formatThe element has child elements: , , and . There are multiple ; elements, but only one and element.The elements have child elements: , , , , , &lt;javadoc_lines>, &lt;single_comment_lines> and &lt;multi_comment_lines>. The element contains the name of the package as a String and the other elements contain totals as Integers.The element has child elements: , , , , &lt;javadoc_lines>, &lt;single_comment_lines> and &lt;multi_comment_lines>. These elements are the sum of all the corresponding children inside the parentThe element seems to be a HTML table.The element has child elements: , and . There are multiple elements, the element contains the average results for all the elements and the element providing some form of total or average.The element has child elements: and . Again there are multiple elements with the element providing some form of total or average (interestingly the result appears to be the same as from ).Now, let‚Äôs take a look at what Maven 2 gives us:2008-04-1211:43:06 com.onedash.common 1 3 10 3 &lt;javadoc_lines>12&lt;/javadoc_lines> &lt;single_comment_lines>0&lt;/single_comment_lines> &lt;multi_comment_lines>0&lt;/multi_comment_lines> &mldr; &mldr; 5 8 46 10 &lt;javadoc_lines>42&lt;/javadoc_lines> &lt;single_comment_lines>3&lt;/single_comment_lines> &lt;multi_comment_lines>3&lt;/multi_comment_lines> PackagesClassesFunctionsNCSSJava 4.005.008.0046.0010.00P 1.252.0011.502.50Packag 1.609.202.00Class&lt; 5.751.25Function&lt;/ com.onedash.common.api.Namer 2 1 0 1 &mldr; &mldr; 6.60 1.60 0.00 2.00 46.00 com.onedash.common.api.Namer.newName() 1 1 0 &mldr; 46.00Thankfully, this is the same format as for ANT. You will also be relieved to know that this is the format generated by the JavaNCSS program directly. Thus we only have to write one parser, and we do not have to detect what format we are parsing. But before I forget:Best Practice #1:When there are multiple formats of a report generated by different tools, make sure that your Hudson plugin can detect the different formats and can handle them appropriately (by either delegating to a different parser implementation, or by handling the differences on the fly).One of the goals of Hudson is to minimise configuration. So when a plugin can detect an configuration option automatically, it should detect it automatically (possibly providing an ‚ÄúAdvanced‚Äù option button to let users override the detection if Hudson gets it wrong)Start smallLooking at the JavaNCSS output, I see that there is a lot of information&mldr; and I only have one more Part left in this series! So I am not going to parse everything. I am sure that in the future I will extend the Hudson plugin to parse all of the file, but for now I am just going to concentrate on the element. This gives users something useful and it‚Äôs better than nothing.But what happens when I do get around to parsing the and elements? People may have lots of old builds and they will want to see the trends of the and results. I have two choices:Tell them ‚ÄúSorry, out of luck‚ÄùSave the results with the build, and then the newer parser can extract the results when people want the trend.Choosing between these two options can be difficult. My preference is to go with option two, as long as the results are not a really big file.Best Practice #2:If you are not parsing everything in the results file, and the results file is not too big, and it can be parsed without reference to the source code, copy the results file to Hudson so that future versions of your plugin can read the information you are not currently parsing.Don‚Äôt over parseThe results that we parse are going to be placed into an Action object. This Action object will be serialized. When Hudson starts up, it reads all the results of all the builds. If we place too much information in our Action object, this can have a detrimental effect on Hudson‚Äôs performance. When users have 50+ projects each with a couple of hundred builds, they will thank you for keeping your Action objects small.Gotcha #2:Don‚Äôt store too much in your Action objects.Don‚Äôt under parseOK, so I have just given out about storing too much in your Action objects. There is a second problem&mldr; not storing enough! Most reporting plugins try to present a trend graph to show progress over a number of builds. If we don‚Äôt store the information required to generate this trend graph inside our Action objects, then displaying the trend graph will require parsing all the result files for all builds of a project. This can have a detrimental effect on Hudson‚Äôs performance. When users have projects with a couple of hundred builds, they will thank you for keeping the information to generate the main trend graph inside your Action objects.Gotcha #3:Store the information for generating the Project level trend graph in your Action objects.A case in point for Gotach #3 is the cobertura plugin, which at the time of writing, does not store the information for the main trend graph in the Action object. I fully intend to fix this situation once I have finished this series!How to parseMost of the result files that you will encounter are XML based. We are writing our plugins in Java, so that gives us a range of parsers to choose from, e.g.SAXDOMStAXRoll your ownEtc.Given that report files can end up very big for very big projects, we need to be careful how we parse the results:Gotcha #4:Don‚Äôt parse XML results using DOM, as this will require reading the entire report file into memory.I am going to stick my neck out and make a recommendation:Best Practice #3:Use an XML pull parser to parse XML report files.They are generally faster, use less memory, and are better suited to a ‚Äúhit-and-run‚Äù style of result extraction.Be able to aggregate parsing resultsYou may think that there will only ever be one result file that you need to parse. Maven 2 usually throws a spanner into that model, and everyone has their own ANT build script, so:Gotcha #5:Don‚Äôt assume you only have to parse one report file for each project.This gotcha arrives from the code coverage plugins (emma, clover, cobertura). Initially, you would think that people are only interested in one code coverage result, i.e. the coverage for the project&mldr; so they will only have one result file that we need to parse, right? Wrong! Some tools/build scripts generate a report for each module but only generate a summary report in non-conforming HTML. Some tools / build scripts generate a report for unit tests and integration tests separately. It‚Äôs a mess, and don‚Äôt get me started on using different tools for different test types&mldr;The parsing engineOk, so here is the parsing engine:package hudson.plugins.javancss.parser;import hudson.model.AbstractBuild;import hudson.util.IOException2;import org.xmlpull.v1.XmlPullParser;import org.xmlpull.v1.XmlPullParserException;import org.xmlpull.v1.XmlPullParserFactory;import java.io.<em>;import java.util.</em>;public class Statistic implements Serializable { private AbstractBuild owner; private String name; private long classes; private long functions; private long ncss; private long javadocs; private long javadocLines; private long singleCommentLines; private long multiCommentLines; public static Collection parse(File inFile) throws IOException, XmlPullParserException { Collection results = new ArrayList(); FileInputStream fis = null; BufferedInputStream bis = null; try { fis = new FileInputStream(inFile); bis = new BufferedInputStream(fis); XmlPullParserFactory factory = XmlPullParserFactory.newInstance(); factory.setNamespaceAware(true); factory.setValidating(false); XmlPullParser parser = factory.newPullParser(); parser.setInput(bis, null); // check that the first tag is expectNextTag(parser, &ldquo;javancss&rdquo;); // skip until we get to the tag while (parser.getDepth() > 0 && (parser.getEventType() != XmlPullParser.START_TAG || !&ldquo;packages&rdquo;.equals(parser.getName()))) { parser.next(); } while (parser.getDepth() > 0 && (parser.getEventType() != XmlPullParser.START_TAG || !&ldquo;package&rdquo;.equals(parser.getName()))) { parser.next(); } while (parser.getDepth() >= 2 && parser.getEventType() == XmlPullParser.START_TAG && &ldquo;package&rdquo;.equals(parser.getName())) { Map&lt;String, String> data = new HashMap&lt;String, String>(); String lastTag = null; String lastText = null; int depth = parser.getDepth(); while (parser.getDepth() >= depth) { parser.next(); switch (parser.getEventType()) { case XmlPullParser.START_TAG: lastTag = parser.getName(); break; case XmlPullParser.TEXT: lastText = parser.getText(); break; case XmlPullParser.END_TAG: if (parser.getDepth() == 4 && lastTag != null && lastText != null) { data.put(lastTag, lastText); } lastTag = null; lastText = null; break; } } if (data.containsKey(&ldquo;name&rdquo;)) { Statistic s = new Statistic(data.get(&ldquo;name&rdquo;)); s.setClasses(Long.valueOf(data.get(&ldquo;classes&rdquo;))); s.setFunctions(Long.valueOf(data.get(&ldquo;functions&rdquo;))); s.setNcss(Long.valueOf(data.get(&ldquo;ncss&rdquo;))); s.setJavadocs(Long.valueOf(data.get(&ldquo;javadocs&rdquo;))); s.setJavadocLines(Long.valueOf(data.get(&ldquo;javadoc_lines&rdquo;))); s.setSingleCommentLines(Long.valueOf(data.get(&ldquo;single_comment_lines&rdquo;))); s.setMultiCommentLines(Long.valueOf(data.get(&ldquo;multi_comment_lines&rdquo;))); results.add(s); } parser.next(); } } catch (XmlPullParserException e) { throw new IOException2(e); } finally { if (bis != null) { bis.close(); } if (fis != null) { fis.close(); } } return results; } private static void skipTag(XmlPullParser parser) throws IOException, XmlPullParserException { parser.next(); endElement(parser); } private static void expectNextTag(XmlPullParser parser, String tag) throws IOException, XmlPullParserException { while (true) { if (parser.getEventType() != XmlPullParser.START_TAG) { parser.next(); continue; } if (parser.getName().equals(tag)) { return; } throw new IOException(&ldquo;Expecting tag " + tag); } } private static void endElement(XmlPullParser parser) throws IOException, XmlPullParserException { int depth = parser.getDepth(); while (parser.getDepth() >= depth) { parser.next(); } } public Statistic(String name) { this.name = name; } &mldr; // Simple getters and setters for all the private fields &mldr; // equals based on all private fields, hashCode based on // name and owner. &mldr; // toString &mldr;}Essentially the main work is done in the static parse method. It takes a File and tries to parse it. We get an XML Pull Parser for the stream and ensure that it is neither namespace aware nor validating as the file format does not use namespaces and we will be forgiving on the XML format.The first tag should be and after that we skip until we get a tag. Once we have found the tag we skip until we hit the first tag.We are reverse engineering the JavaNCSS file format, so we will not make any assumptions about the order of the child elements in the element. We put all the child elements into a Map keyed by the element name, and then when we reach the end of the element we pull out the information we were after from the Map and put it into a Statistic object and add that to the collection of results that we will return.As soon as we hit the end of the element, we stop parsing.Supporting aggregationIn order to support aggregation of multiple results, we&rsquo;ll add some utility methods to the Statistic class, first we need methods that allow us to calculate totals:package hudson.plugins.javancss.parser;&mldr;public class Statistic implements Serializable { &mldr; public static Statistic total(Collection&mldr; results) { Collection merged = merge(results); Statistic total = new Statistic(&rdquo;"); for (Statistic individual : merged) { total.add(individual); } return total; } public void add(Statistic r) { classes += r.classes; functions += r.functions; ncss += r.ncss; javadocs += r.javadocs; javadocLines += r.javadocLines; singleCommentLines += r.singleCommentLines; multiCommentLines += r.multiCommentLines; } &mldr;}The total method just calculates the total of all the statistics in a collection of statistics. We will also need to be able to merge different result sets. This should aggregate totals for each package separately and return a collection with one total statistic for each package:package hudson.plugins.javancss.parser;&mldr;public class Statistic implements Serializable { &mldr; public static Collection merge( Collection&mldr; results) { if (results.length == 0) { return Collections.emptySet(); } else if (results.length == 1) { return results[0]; } else { Map&lt;String, Statistic> merged = new HashMap&lt;String, Statistic>(); for (Collection result : results) { for (Statistic individual : result) { if (!merged.containsKey(individual.name)) { merged.put(individual.name, new Statistic(individual.name)); } merged.get(individual.name).add(individual); } } return merged.values(); } } &mldr;}That is pretty much it for the parser engine.The GhostwriterNow we need to hook the engine into our publisher. We will need to configure the UI elements and the Actions&mldr; all tasks for the final part, but for now, we&rsquo;ll just hook it up. We want to run the parsing on the slave side so we implement Ghostwriter.SlaveGhostwriter.package hudson.plugins.javancss;import hudson.FilePath;import hudson.model.AbstractBuild;import hudson.model.BuildListener;import hudson.plugins.helpers.BuildProxy;import hudson.plugins.helpers.Ghostwriter;import hudson.plugins.javancss.parser.Statistic;import org.xmlpull.v1.XmlPullParserException;import java.io.File;import java.io.IOException;import java.util.Collection;import java.util.HashSet;import java.util.Set;public class JavaNCSSGhostwriter implements Ghostwriter, Ghostwriter.SlaveGhostwriter { private final String reportFilenamePattern; public JavaNCSSGhostwriter(String reportFilenamePattern) { this.reportFilenamePattern = reportFilenamePattern; } public boolean performFromSlave( BuildProxy build, BuildListener listener) throws InterruptedException, IOException { FilePath[] paths = build.getExecutionRootDir() .list(reportFilenamePattern); Collection results = null; Set parsedFiles = new HashSet(); for (FilePath path : paths) { final String pathStr = path.getRemote(); if (!parsedFiles.contains(pathStr)) { parsedFiles.add(pathStr); try { Collection result = Statistic.parse(new File(pathStr)); if (results == null) { results = result; } else { results = Statistic.merge(results, result); } // TODO copy the parsed file to the master } catch (XmlPullParserException e) { e.printStackTrace(listener.getLogger()); } } } // TODO add the results into an Action an attach it to the // build. return true; }}Basically, we search the supplied wildcard-path for report files and merge all the results together into a collection of results. In the final part of this series we will create our Action to hold the results and wire everything together.</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Tue, 01 Apr 2008 00:00:00 +0000" class=no-wrap title=" Tue, 01 Apr 2008 00:00:00 +0000">Tue, 01 Apr 2008 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2008-03-01-writing-a-hudson-plugin-part-5-typos-corrected/>Writing a Hudson plugin (Part 5¬Ω - Typos corrected)</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>Ok, life has got in the way and I have not been able to update this series as quickly as I originally intended. In any case, there were a number of bugs in Hudson that I discovered and are now fixed, and there was a good deal of tidy-up needed in order for me to figure out what to do for parts 6 and 7. The good news is that I am getting closer to finishing writing these final two parts. The bad news is that there are a number of corrections to the previous posts (I have put some corrections in-line for parts 4 and 5). This post aims to ensure that, for parts 6 and 7, everyone is able to follow from the same code!pom.xmlThis needs to be updated to reference a Hudson version of at least 1.200 in order to have the bugs I identified fixed.src/main/java/hudson/plugins/helpers/AbstractBuildAction.javaAFAIK I escaped all the HTML entities and this file is the same as constructed from the previous posts.package hudson.plugins.helpers;import hudson.model.AbstractBuild;import hudson.model.HealthReportingAction;public abstract class AbstractBuildAction&lt;BUILD extends AbstractBuild> implements HealthReportingAction { private BUILD build = null; protected AbstractBuildAction() { } public synchronized BUILD getBuild() { return build; } public synchronized void setBuild(BUILD build) { if (this.build == null && this.build != build) { this.build = build; } } public boolean isFloatingBoxActive() { return false; } public boolean isGraphActive() { return false; } public String getGraphName() { return getDisplayName(); } public String getSummary() { return &ldquo;&rdquo;; }}src/main/java/hudson/plugins/helpers/AbstractMavenReporterImpl.javaAFAIK I escaped all the HTML entities and this file is the same as constructed from the previous posts.package hudson.plugins.helpers;import hudson.maven.MavenBuildProxy;import hudson.maven.MavenReporter;import hudson.maven.MojoInfo;import hudson.model.BuildListener;import hudson.model.Result;import org.apache.maven.project.MavenProject;import java.io.IOException;public abstract class AbstractMavenReporterImpl extends MavenReporter { protected MojoExecutionReportingMode getExecutionMode() { return MojoExecutionReportingMode.ONLY_REPORT_ON_SUCCESS; } public boolean postExecute(MavenBuildProxy build, MavenProject pom, MojoInfo mojo, BuildListener listener, Throwable error) throws InterruptedException, IOException { if (!isExecutingMojo(mojo)) { // not a mojo who&rsquo;s result we are interested in return true; } final Boolean okToContinue = getExecutionMode().isOkToContinue(this, build, listener, error); if (okToContinue != null) { return okToContinue; } build.registerAsProjectAction(this); return BuildProxy.doPerform(newGhostwriter(pom, mojo), build, pom, listener); } protected abstract boolean isExecutingMojo(MojoInfo mojo); protected abstract Ghostwriter newGhostwriter(MavenProject pom, MojoInfo mojo); public boolean preExecute(MavenBuildProxy build, MavenProject pom, MojoInfo mojo, BuildListener listener) throws InterruptedException, IOException { return !isAutoconfMojo(mojo) || autoconfPom(build, pom, mojo, listener); } protected boolean autoconfPom(MavenBuildProxy build, MavenProject pom, MojoInfo mojo, BuildListener listener) { return true; } protected boolean isAutoconfMojo(MojoInfo mojo) { return false; } protected enum MojoExecutionReportingMode { ONLY_REPORT_ON_SUCCESS { Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error) { return error == null ? null : Boolean.TRUE; } }, ALWAYS_REPORT_STABLE { Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error) { return null; }}, REPORT_UNSTABLE_ON_ERROR { Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error) { if (error != null) { listener.getLogger().println("[HUDSON] " + reporter.getDescriptor().getDisplayName() + " setting build to UNSTABLE"); build.setResult(Result.UNSTABLE); } return null; } }; abstract Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error); }}src/main/java/hudson/plugins/helpers/AbstractProjectAction.javaAFAIK I escaped all the HTML entities and this file is the same as constructed from the previous posts.package hudson.plugins.helpers;import hudson.model.AbstractProject;import hudson.model.Actionable;abstract public class AbstractProjectAction&lt;PROJECT extends AbstractProject> extends Actionable { private final PROJECT project; protected AbstractProjectAction(PROJECT project) { this.project = project; } public PROJECT getProject() { return project; } public boolean isFloatingBoxActive() { return true; } public boolean isGraphActive() { return false; } public String getGraphName() { return getDisplayName(); }}src/main/java/hudson/plugins/helpers/AbstractPublisherImpl.javaSome of the HTML entities were not properly escaped.package hudson.plugins.helpers;import hudson.tasks.Publisher;import hudson.model.AbstractBuild;import hudson.model.BuildListener;import hudson.Launcher;import java.io.IOException;public abstract class AbstractPublisherImpl extends Publisher { protected abstract Ghostwriter newGhostwriter(); public boolean perform(AbstractBuild build, Launcher launcher, final BuildListener listener) throws InterruptedException, IOException { return BuildProxy.doPerform(newGhostwriter(), build, listener); } public boolean prebuild(AbstractBuild build, BuildListener listener) { return true; }}src/main/java/hudson/plugins/helpers/BuildProxy.javaAgain, some of the HTML entities were not properly escaped. Additionally, this is the file that has had the most updates during this tutorial, so here it is in full:package hudson.plugins.helpers;import hudson.FilePath;import hudson.maven.MavenBuildProxy;import hudson.util.IOException2;import hudson.model.Action;import hudson.model.Result;import hudson.model.AbstractBuild;import hudson.model.BuildListener;import java.util.Calendar;import java.util.List;import java.util.ArrayList;import java.io.IOException;import java.io.Serializable;import org.apache.maven.project.MavenProject;public final class BuildProxy implements Serializable { private final FilePath artifactsDir; private final FilePath projectRootDir; private final FilePath buildRootDir; private final FilePath executionRootDir; private final Calendar timestamp; private final List&lt;AbstractBuildAction&lt;AbstractBuild&#187; actions = new ArrayList&lt;AbstractBuildAction&lt;AbstractBuild&#187;(); private Result result = null; private boolean continueBuild = true; public static boolean doPerform(Ghostwriter ghostwriter, AbstractBuild build, BuildListener listener) throws IOException, InterruptedException { // first, do we need to do anything on the slave if (ghostwriter instanceof Ghostwriter.SlaveGhostwriter) { // construct the BuildProxy instance that we will use BuildProxy buildProxy = new BuildProxy( new FilePath(build.getArtifactsDir()), new FilePath(build.getProject().getRootDir()), new FilePath(build.getRootDir()), build.getProject().getModuleRoot(), build.getTimestamp()); BuildProxyCallableHelper callableHelper = new BuildProxyCallableHelper( buildProxy, ghostwriter, listener); try { buildProxy = buildProxy.getExecutionRootDir().act(callableHelper); buildProxy.updateBuild(build); // terminate the build if necessary if (!buildProxy.isContinueBuild()) { return false; } } catch (Exception e) { throw unwrapException(e, listener); } } // finally, on to the master final Ghostwriter.MasterGhostwriter masterGhostwriter = Ghostwriter.MasterGhostwriter.class.cast(ghostwriter); return masterGhostwriter == null || masterGhostwriter.performFromMaster(build, build.getProject().getModuleRoot(), listener); } private static RuntimeException unwrapException(Exception e, BuildListener listener) throws IOException, InterruptedException { if (e.getCause() instanceof IOException) { throw new IOException2(e.getCause().getMessage(), e); } if (e.getCause() instanceof InterruptedException) { e.getCause().printStackTrace(listener.getLogger()); throw new InterruptedException(e.getCause().getMessage()); } if (e.getCause() instanceof RuntimeException) { throw new RuntimeException(e.getCause()); } // How on earth do we get this far down the branch e.printStackTrace(listener.getLogger()); throw new RuntimeException(&ldquo;Unexpected exception&rdquo;, e); } public void updateBuild(AbstractBuild build) { for (AbstractBuildAction&lt;AbstractBuild> action : actions) { if (!build.getActions().contains(action)) { action.setBuild(build); build.getActions().add(action); } } if (result != null && result.isWorseThan(build.getResult())) { build.setResult(result); } } public static boolean doPerform(Ghostwriter ghostwriter, MavenBuildProxy mavenBuildProxy, MavenProject pom, final BuildListener listener) throws InterruptedException, IOException { // first, construct the BuildProxy instance that we will use BuildProxy buildProxy = new BuildProxy( mavenBuildProxy.getArtifactsDir(), mavenBuildProxy.getProjectRootDir(), mavenBuildProxy.getRootDir(), new FilePath(pom.getBasedir()), mavenBuildProxy.getTimestamp()); // do we need to do anything on the slave if (ghostwriter instanceof Ghostwriter.SlaveGhostwriter) { final Ghostwriter.SlaveGhostwriter slaveGhostwriter = (Ghostwriter.SlaveGhostwriter) ghostwriter; // terminate the build if necessary if (!slaveGhostwriter.performFromSlave(buildProxy, listener)) { return false; } } // finally, on to the master try { return mavenBuildProxy.execute(new BuildProxyCallableHelper( buildProxy, ghostwriter, listener)); } catch (Exception e) { throw unwrapException(e, listener); } } private BuildProxy(FilePath artifactsDir, FilePath projectRootDir, FilePath buildRootDir, FilePath executionRootDir, Calendar timestamp) { this.artifactsDir = artifactsDir; this.projectRootDir = projectRootDir; this.buildRootDir = buildRootDir; this.executionRootDir = executionRootDir; this.timestamp = timestamp; } public List&lt;AbstractBuildAction&lt;AbstractBuild&#187; getActions() { return actions; } public FilePath getArtifactsDir() { return artifactsDir; } public FilePath getBuildRootDir() { return buildRootDir; } public FilePath getExecutionRootDir() { return executionRootDir; } public FilePath getProjectRootDir() { return projectRootDir; } public Calendar getTimestamp() { return timestamp; } public Result getResult() { return result; } public void setResult(Result result) { this.result = result; } public boolean isContinueBuild() { return continueBuild; } public void setContinueBuild(boolean continueBuild) { this.continueBuild = continueBuild; }}src/main/java/hudson/plugins/helpers/BuildProxyCallableHelper.javaLost some HTML entities (again!)package hudson.plugins.helpers;import hudson.remoting.Callable;import hudson.maven.MavenBuildProxy;import hudson.maven.MavenBuild;import hudson.model.BuildListener;import java.io.IOException;class BuildProxyCallableHelper implements Callable&lt;BuildProxy, Exception>, MavenBuildProxy.BuildCallable&lt;Boolean, Exception> { private final BuildProxy buildProxy; private final Ghostwriter ghostwriter; private final BuildListener listener; BuildProxyCallableHelper(BuildProxy buildProxy, Ghostwriter ghostwriter, BuildListener listener) { this.buildProxy = buildProxy; this.ghostwriter = ghostwriter; this.listener = listener; } public Boolean call(MavenBuild mavenBuild) throws Exception { buildProxy.updateBuild(mavenBuild); if (ghostwriter instanceof Ghostwriter.MasterGhostwriter) { final Ghostwriter.MasterGhostwriter masterBuildStep = (Ghostwriter.MasterGhostwriter) ghostwriter; return masterBuildStep.performFromMaster(mavenBuild, buildProxy.getExecutionRootDir(), listener); } return true; } public BuildProxy call() throws Exception { if (ghostwriter instanceof Ghostwriter.SlaveGhostwriter) { final Ghostwriter.SlaveGhostwriter slaveBuildStep = (Ghostwriter.SlaveGhostwriter) ghostwriter; try { buildProxy.setContinueBuild( slaveBuildStep.performFromSlave(buildProxy, listener)); return buildProxy; } catch (IOException e) { throw new Exception(e); } catch (InterruptedException e) { throw new Exception(e); } } return buildProxy; }}src/main/java/hudson/plugins/helpers/Ghostwriter.javaJava Generics are a real gotcha for HTML entitiespackage hudson.plugins.helpers;import hudson.model.BuildListener;import hudson.model.AbstractBuild;import hudson.FilePath;import java.io.Serializable;import java.io.IOException;public interface Ghostwriter extends Serializable { public static interface SlaveGhostwriter extends Ghostwriter { boolean performFromSlave(BuildProxy build, BuildListener listener) throws InterruptedException, IOException; } public static interface MasterGhostwriter extends Ghostwriter { boolean performFromMaster(AbstractBuild build, FilePath executionRoot, BuildListener listener) throws InterruptedException, IOException; }}src/main/resources/hudson/plugins/helpers/AbstractBuildAction/enlargedGraph.jellyI left a &ldquo;css&rdquo; attribute in the &lt;l:layout> tag.&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags"> &lt;st:include it="${it.build}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;largeGraph.jelly&rdquo;/> &lt;/j:if> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractBuildAction/floatingBox.jellyThe &lt;j:if> should be based on the from variable and not it&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;j:if test="${from.graphActive}"> ${from.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> enlarge &lt;/j:if>&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractBuildAction/index.jellyI left a &ldquo;css&rdquo; attribute in the &lt;l:layout> tag.&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags"> &lt;st:include it="${it.build}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> ${it.displayName} &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> &lt;/j:if> &lt;st:include page=&ldquo;reportDetail.jelly&rdquo;/> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractBuildAction/largeGraph.jelly, src/main/resources/hudson/plugins/helpers/AbstractBuildAction/normalGraph.jelly, and src/main/resources/hudson/plugins/helpers/AbstractBuildAction/reportDetail.jellyThese are all the same content, and are basically empty placeholders to be overrided in classes that extend AbstractBuildAction. I do not think there are any corrections.&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractBuildAction/summary.jellyThe &lt;j:if> had an extra } in the expression&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form" xmlns:i=&ldquo;jelly:fmt&rdquo;> &lt;t:summary icon="${it.iconFileName}"> ${it.displayName} ${it.summary} &lt;/t:summary> &lt;j:if test="${it.floatingBoxActive}"> &lt;st:include page=&ldquo;floatingBox.jelly&rdquo;/> &lt;/j:if>&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractProjectAction/enlargedGraph.jellyI left a &ldquo;css&rdquo; attribute in the &lt;l:layout> tag.&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags"> &lt;st:include it="${it.project}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;largeGraph.jelly&rdquo;/> &lt;/j:if> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractProjectAction/floatingBox.jellyThe &lt;j:if> should be based on the from variable and not it&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form" xmlns:i=&ldquo;jelly:fmt&rdquo; xmlns:local=&ldquo;local&rdquo;> &lt;j:if test="${from.graphActive}"> ${from.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> enlarge &lt;/j:if>&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractProjectAction/index.jellyI left a &ldquo;css&rdquo; attribute in the &lt;l:layout> tag.&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags"> &lt;st:include it="${it.project}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> ${it.displayName} &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> &lt;/j:if> &lt;st:include page=&ldquo;reportDetail.jelly&rdquo;/> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>src/main/resources/hudson/plugins/helpers/AbstractProjectAction/largeGraph.jelly, src/main/resources/hudson/plugins/helpers/AbstractProjectAction/normalGraph.jelly, and src/main/resources/hudson/plugins/helpers/AbstractProjectAction/reportDetail.jellyThese are all the same content, and are basically empty placeholders to be overrided in classes that extend AbstractProjectAction. I do not think there are any corrections.&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly></p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Sat, 01 Mar 2008 00:00:00 +0000" class=no-wrap title=" Sat, 01 Mar 2008 00:00:00 +0000">Sat, 01 Mar 2008 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2008-02-01-writing-a-hudson-plug-in-part-4-abstract-publishers-and-mavenreporters/>Writing a Hudson plug-in (Part 4 ‚Äì Abstract Publishers and MavenReporters)</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>This is the fourth installment, which covers the two abstract classes that call the Ghostwriter for us. When we implement our plugin we will extend from these two classes. These classes perform the work of calling the Ghostwriter at the appropriate points in the build, the concrete classes that we will develop in Part 5, however have the responsibility of creating a configured Ghostwriter and providing it to the superclass for execution.AbstractPublisherImplIn a way, this is the simplest of the two classes:package hudson.plugins.helpers;import hudson.tasks.Publisher;import hudson.model.AbstractBuild;import hudson.model.BuildListener;import hudson.Launcher;import java.io.IOException;public abstract class AbstractPublisherImpl extends Publisher { protected abstract Ghostwriter newGhostwriter(); public boolean perform(AbstractBuild build, Launcher launcher, final BuildListener listener) throws InterruptedException, IOException { return BuildProxy.doPerform(newGhostwriter(), build, listener); } public boolean prebuild(AbstractBuild build, BuildListener listener) { return true; }}Fairly simple, we just ask the BuildProxy to invoke the new Ghostwriter created by the concrete class.AbstractMavenReporterImplThis class needs to do a bit more work. First I&rsquo;ll present the abstract methods and protected methods that can be overrided by implementing classes:package hudson.plugins.helpers;import hudson.maven.MavenReporter;import hudson.maven.MojoInfo;import hudson.maven.MavenBuildProxy;import hudson.model.BuildListener;import hudson.model.Result;import hudson.plugins.helpers.BuildProxy;import hudson.plugins.javancss.PluginImpl;import org.apache.maven.project.MavenProject;import java.io.IOException;public abstract class AbstractMavenReporterImpl extends MavenReporter { protected abstract boolean isExecutingMojo(MojoInfo mojo); protected abstract Ghostwriter newGhostwriter(MavenProject pom, MojoInfo mojo); protected boolean autoconfPom(MavenBuildProxy build, MavenProject pom, MojoInfo mojo, BuildListener listener) { return true; } protected boolean isAutoconfMojo(MojoInfo mojo) { return false; }}Maven project execution consists of invocations of various golas of the different mojos that are bound to the Maven lifecycle. Hudson inserts hooks that allow us to intercept mojos before they execute and after they have executed. Intercepting prior to execution can be useful to ensure that the plugin has been configured with the options we require (e.g. XML output enabled). Post execution is usually when we want to invoke our Ghostwriter. If the implementing class wants to be able to tweak the mojo configuration prior to execution it needs to override isAutoconfMojo in order to identify the mojo executions that need to be tweaked, and override autoconfPom to do the actual configuration.The implementing class needs to provide:a isExecutingMojo method to identify execution of the mojo that this publisher reports on.a newGhostwriter method that constructs the Ghostwriter which will do the work for us. The new Ghostwriter can either be configured manually on the build page, and/or can be configured based on information in the pom.The final thing that we need to decide is when to execute the publisher:package hudson.plugins.helpers;&mldr;public abstract class AbstractMavenReporterImpl extends MavenReporter { &mldr; protected MojoExecutionReportingMode getExecutionMode() { return MojoExecutionReportingMode.ONLY_REPORT_ON_SUCCESS; } &mldr; protected enum MojoExecutionReportingMode { ONLY_REPORT_ON_SUCCESS { Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error) { return error == null ? null : Boolean.TRUE; } }, ALWAYS_REPORT_STABLE { Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error) { return null; }}, REPORT_UNSTABLE_ON_ERROR { Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error) { if (error != null) { listener.getLogger().println("[HUDSON] " + reporter.getDescriptor().getDisplayName() + " setting build to UNSTABLE"); build.setResult(Result.UNSTABLE); } return null; } }; abstract Boolean isOkToContinue(MavenReporter reporter, MavenBuildProxy build, BuildListener listener, Throwable error); }}We define three different execution modes:ONLY_REPORT_ON_SUCCESS - this ensures that we only run the publisher if the mojo executed without error.ALWAYS_REPORT_STABLE - runs the publisher even if the mojo had an execution error, never marks the build as failed or unstable (note that Maven will most likely mark the build as failed or unstable)REPORT_UNSTABLE_ON_ERROR - runs the publisher even if the mojo had an execution error. In the event of a mojo execution error the build will be marked UNSTABLEAll that&rsquo;s left is are the methods to tie these all together:package hudson.plugins.helpers;&mldr;public abstract class AbstractMavenReporterImpl extends MavenReporter { &mldr;. public boolean preExecute(MavenBuildProxy build, MavenProject pom, MojoInfo mojo, BuildListener listener) throws InterruptedException, IOException { return !isAutoconfMojo(mojo) || autoconfPom(build, pom, mojo, listener); } public boolean postExecute(MavenBuildProxy build, MavenProject pom, MojoInfo mojo, BuildListener listener, Throwable error) throws InterruptedException, IOException { if (!isExecutingMojo(mojo)) { // not a mojo who&rsquo;s result we are interested in return true; } final Boolean okToContinue = getExecutionMode() .isOkToContinue(this, build, listener, error); if (okToContinue != null) { return okToContinue; } build.registerAsProjectAction(this); return BuildProxy.doPerform(newGhostwriter(pom, mojo), build, pom, listener); }}The preExecute method checks if this is an mojo execution that we want to tweak, executing the tweaks if necessary. The postExecute method checks if this the the mojo we want to report on. Then it checks if there were execution errors, following the execution mode reported by getExecutionMode. We register this MavenReporter as a project action (thus signalling Hudson that it should call the getProjectAction() method of our reporter. We will have this method return null if we actually don&rsquo;t want a project action. This is safer than trying to be smart and only calling register if we want a project action!). Finally we invoke the Ghostwriter!SummaryWell that&rsquo;s it for Part 4. In the next installment, I will introduce a DRY set of classes for the reports that the publisher will generate</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Fri, 01 Feb 2008 00:00:00 +0000" class=no-wrap title=" Fri, 01 Feb 2008 00:00:00 +0000">Fri, 01 Feb 2008 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2008-02-01-writing-a-hudson-plug-in-part-5-reporting/>Writing a Hudson plug-in (Part 5 ‚Äì Reporting)</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>Until now we have been generating classes that collect the results we want to display. We have not hooked into Hudson&rsquo;s methods of displaying reports. There are essentially four places that we could want to generate reports:In each individual build (we&rsquo;ll call this a Single Build Report),In the project (we&rsquo;ll call this a Single Project Report),In the summary of all the Maven 2 module builds associated with a multi-module Maven 2 build (we&rsquo;ll call this an Aggregate Build Report), and finallyIn the Maven 2 project itself (we&rsquo;ll call this an Aggregate Project Report).To make matters more confusing, each of these reports usually to implement different classes and need to implement different interfaces:Project Reports usually inherit from ActionableBuild Reports usually inherit from HealthReportingActionSingle Build Reports in Maven 2 projects need to implement AggregatableActionWhat we need is to put some common framework around these reports to ensure that we are not repeating ourselves all the time. In general, each of these four reports will be doing mostly the same things.The Build Reports will be displaying the results for a specific buildThe Project Reports will be displaying the results for the latest build (and possibly a trend chart if that makes sense)The Aggregate Reports will be displaying the aggregate of all the Single ReportsSound&rsquo;s like a job for multiple inheritance! Fortune would have it that Java does not support multiple inheritance, so we will have to use some form of composition to get the same effect, and generics can help reduce the repetition too. But enough! On to the solution.AbstractBuildActionWe&rsquo;ll start with a parent class for all our Build Reports. We&rsquo;ll make this class generic, parameterised by the Build class that it operates on, so that we can use the same core code for all the Build Reports:package hudson.plugins.helpers;import hudson.model.AbstractBuild;import hudson.model.HealthReportingAction;public abstract class AbstractBuildAction&lt;BUILD extends AbstractBuild> implements HealthReportingAction { private BUILD build = null; protected AbstractBuildAction() { } public synchronized BUILD getBuild() { return build; } public synchronized void setBuild(BUILD build) { if (this.build == null && this.build != build) { this.build = build; } }}We store a reference to the build in a local variable and provide a getter for the build. Ideally we would like to the build variable to be final and initialize it in the constructor. However, Hudson&rsquo;s remoting interface will get in the way of this for any actions created on the slave. The solution is to use a setter to set the build. Additionally, we have some logic that makes this setter write-once. This is just a safety net to stop us from accidentally confusing Hudson. Strictly speaking, if you are careful the setter can be justa a simple setter and not write once.[Correction] We also need to modify BuildProxy so that it calls our setter for us for actions added from slave side executions:package hudson.plugsin.helpers;&mldr;public final class BuildProxy implements Serializable { &mldr; private final List&lt;AbstractBuildAction&lt;AbstractBuild&#187; actions = new ArrayList&lt;AbstractBuildAction&#187;(); &mldr; public void updateBuild(AbstractBuild&lt;,?> build) { for (AbstractBuildAction&lt;AbstractBuild> action: actions) { if (!build.getActions().contains(action)) { action.setBuild(build); build.getActions().add(action); } } if (result != null && result.isWorseThan(build.getResult())) { build.setResult(result); } } &mldr; public List&lt;AbstractBuildAction&lt;AbstractBuild&#187; getActions() { return actions; } &mldr;}[/Correction]In addition to these simple getters and setters, we want to provide a framework for displaying the report detail. Each different type of report has different ways of fitting into the Hudson UI. We are going to attempt to standardise these by using wrapper .jelly files to call a standard set which implementing classes can override. Jelly files are stored as resources in the hudson plugin, so with the Maven2 project structure for a Hudson plugin, the java source is /src/main/java/hudson/plugins/helpers/AbstractBuildAction.java and the jelly files for this java class are in /src/main/resources/hudson/plugins/helpers/AbstractBuildAction/. The basic things that all build reports want to do are as follows:A main report detail page (e.g. package level summary of the number of lines of code)A graph of some sort, with the option to enlarge it. (e.g. trend graph of the number of lines of code)A simple summary of the report for the main page (i.e. &ldquo;17,345 lines of code (+1,534)")We will implement this functionality with some properties of the AbstractBuildAction, and some default .jelly files. First the additional properties:&mldr;public abstract class AbstractBuildAction&lt;BUILD extends AbstractBuild> implements HealthReportingAction { &mldr; public boolean isFloatingBoxActive() { return false; } public boolean isGraphActive() { return false; } public String getGraphName() { return getDisplayName(); } public String getSummary() { return &ldquo;&rdquo;; }}These four properties will be used to control how the action appears. isFloatingBoxActive allows us to enable the floating box on the build summary page. isGraphActive allows us to activate the graph inside the floating box. getGraphName should return the title that will be displayed above the graph. And finally, getSummary will control the summary text to display beside the build report icon on the build summary page.Next we have some empty default place-holder jelly files. These will be the jelly files that we can override in our actual reports:reportDetail.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout&rdquo; xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly>normalGraph.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly>largeGraph.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly>The reportDetail.jelly page will be used for the main report detail page, the normalGraph.jelly page will be used for the floating trend graph, while the largeGraph.jelly page will be used for the enlarged graph. To hook these pages into the Hudson framework, we need the following jelly pages:index.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags" css="/plugin/javancss/css/style.css"> &lt;st:include it="${it.build}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> ${it.displayName} &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> &lt;/j:if> &lt;st:include page=&ldquo;reportDetail.jelly&rdquo;/> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>This page will also include the trend graph if it is activefloatingBox.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;j:if test="${it.graphActive}"> ${from.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> enlarge &lt;/j:if>&lt;/j:jelly>summary.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form" xmlns:i=&ldquo;jelly:fmt&rdquo;> &lt;t:summary icon="${it.iconFileName}"> ${it.displayName} ${it.summary} &lt;/t:summary> &lt;j:if test="${it.floatingBoxVisible}}"> &lt;st:include page=&ldquo;floatingBox.jelly&rdquo;/> &lt;/j:if>&lt;/j:jelly>Note that the build main page does not support floating boxes, so we have to hack it in via the summary.jelly pageenlargedGraph.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags" css="/plugin/javancss/css/style.css"> &lt;st:include it="${it.build}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;largeGraph.jelly&rdquo;/> &lt;/j:if> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>AbstractProjectActionThis is similar to AbstractBuildAction, however, we don&rsquo;t have to deal with the write-once setter problem.package hudson.plugins.helpers;import hudson.model.AbstractProject;import hudson.model.Actionable;abstract public class AbstractProjectAction&lt;PROJECT extends AbstractProject> extends Actionable { private final PROJECT project; protected AbstractProjectAction(PROJECT project) { this.project = project; } public PROJECT getProject() { return project; } public boolean isFloatingBoxActive() { return true; } public boolean isGraphActive() { return false; } public String getGraphName() { return getDisplayName(); }}Again we have a set of jelly files, we&rsquo;ll repeat the same placeholders:reportDetail.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly>normalGraph.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly>largeGraph.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">&lt;/j:jelly>The other link in pages are similar, only changing from a reference for ${it.build} to ${it.project}index.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags" css="/plugin/javancss/css/style.css"> &lt;st:include it="${it.project}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> ${it.displayName} &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> &lt;/j:if> &lt;st:include page=&ldquo;reportDetail.jelly&rdquo;/> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>floatingBox.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form" xmlns:i=&ldquo;jelly:fmt&rdquo; xmlns:local=&ldquo;local&rdquo;> &lt;j:if test="${it.graphActive}"> ${from.graphName} &lt;st:include page=&ldquo;normalGraph.jelly&rdquo;/> enlarge &lt;/j:if>&lt;/j:jelly>The project page automatically includes the floating box, so we don;t require the summary hackenlargedGraph.jelly&lt;j:jelly xmlns:j=&ldquo;jelly:core&rdquo; xmlns:st=&ldquo;jelly:stapler&rdquo; xmlns:d=&ldquo;jelly:define&rdquo; xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form"> &lt;l:layout xmlns:plugin="/hudson/plugins/javancss/tags" css="/plugin/javancss/css/style.css"> &lt;st:include it="${it.project}" page=&ldquo;sidepanel.jelly&rdquo;/> &lt;l:main-panel> &lt;j:if test="${it.graphActive}"> ${it.graphName} &lt;st:include page=&ldquo;largeGraph.jelly&rdquo;/> &lt;/j:if> &lt;/l:main-panel> &lt;/l:layout>&lt;/j:jelly>SummaryThat&rsquo;s it for part 5, next time we will implement the javancss parser and get the results for a build. Part 7 will finish off the plugin with the reports based on these two base classes.</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Fri, 01 Feb 2008 00:00:00 +0000" class=no-wrap title=" Fri, 01 Feb 2008 00:00:00 +0000">Fri, 01 Feb 2008 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2008-01-13-writing-a-hudson-plug-in-part-1-preparation/>Writing a Hudson plug-in (Part 1 ‚Äì Preparation)</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>Writing a Hudson plug-in (Part 1 ‚Äì Preparation)This is the first part of a tutorial on writing a Hudson plug-in. The aim of this tutorial is to develop a Publisher for JavaNCSS. This publisher will work with both Hudson Freestyle projects and Hudson Maven2 projects. The publisher will also include a trend graph.Before we can start plug-in development, we need to have a set of working projects to throw at our plugin. Ideally these projects should be simple and quick to build, but the most essential thing is that they build and run the tool that we want to publish the results of! We need a minimum of three projects:Ant-based projectMaven2-based single module projectMaven2-based multiple module projectSo we will develop these three basic projects, get them running the JavaNCSS tool, and then ensure they build in Hudson.The Ant-based projectWe‚Äôll start with the Ant based project. First we‚Äôll need a directory structure:project/ src/ main/ test/ lib/ tools/ javancss/Next we need to download the library dependencies to the lib folder (for example junit.jar) and the custom ant tasks to the appropriate sub-folder of tools.You can get JUnit.jar from <a href=http://www.junit.org>http://www.junit.org</a>.The JavaNCSS jars are available at <a href=http://www.kclee.de/clemens/java/javancss/>http://www.kclee.de/clemens/java/javancss/</a> (Note this is the .de domain, not the .com domain). JavaNCSS comes as a zip file, so we‚Äôll just extract the three jar files that we need: ccl.jar, javancss.jar and jhbasic.jarAt this point we should have the followingproject/ src/ main/ test/ lib/ junit.jar tools/ javancss/ ccl.jar javancss.jar jhbasic.jarNext we need a build file, and some sample java files to build. Here is a sample build.xml that will do most of what we want: &lt;pathelement location="${basedir}/tools/javancss/jhbasic.jar" We can then write some simple java classes and test our build. We‚Äôll start with a simple HelloWorld.javapackage com.onedash.hello;/*** A basic hello world application.** @author Stephen Connolly*/public class Hello { public String sayHello(String name) { return &ldquo;Hello " + name; } public static void main(String[] args) { Hello instance = new Hello(); if (args.length == 1) { System.out.println(instance.sayHello(args[0])); } else { System.out.println(instance.sayHello(&ldquo;world&rdquo;)); } }}At this point we should have the following project structure:project/ build.xml src/ main/ com/ onedash/ hello/ Hello.java test/ lib/ junit.jar tools/ javancss/ ccl.jar javancss.jar jhbasic.jarAnd running ANT should give output like:C:\local\project>ant clean distBuildfile: build.xmlclean:[delete] Deleting directory C:\local\project\build[delete] Deleting directory C:\local\project\distcompile: [mkdir] Created dir: C:\local\project\build\classes [javac] Compiling 5 source files to C:\local\project\build\classescompile-tests: [mkdir] Created dir: C:\local\project\build\testcases [javac] Compiling 1 source file to C:\local\project\build\testcasestest: [mkdir] Created dir: C:\local\project\build\testcases\reportsjavancss:[javancss] Generating reportdist: [mkdir] Created dir: C:\local\project\dist [jar] Building jar: C:\local\project\dist\SimpleAntProject.jarBUILD SUCCESSFULTotal time: 3 secondsAnd there should be a javancss-report.xml file in the build directory. That should be enough for an ANT project. Some extra finesse would be to add some more source code so we can examine the structure of the xml report.The Maven2 based single module projectFirst we‚Äôll need a directory structure:project/ src/ main/ java/ test/ java/Next we need a pom.xml to describe the project for Maven2. Here is a simple pom.xml: xsi:schemaLocation=&ldquo;<a href=http://maven.apache.org/POM/4.0.0>http://maven.apache.org/POM/4.0.0</a> <a href=http://maven.apache.org/maven-v4_0_0.xsd%22%3E>http://maven.apache.org/maven-v4_0_0.xsd"></a> 4.0.0 com.onedash.hudson SimpleM2Project SimpleM2Project 1.0-SNAPSHOT jar junit junit 4.4 test package org.codehaus.mojo javancss-maven-plugin process-sources report We can reuse the Hello.java from the Ant project, so at this point we should have the following directory structure:project/ pom.xml src/ main/ java/ com/ onedash/ hello/ Hello.java test/ java/And running maven should give the following output:C:\local\project>mvn clean package[INFO] Scanning for projects&mldr;[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] Building SimpleM2Project[INFO] task-segment: [clean, package][INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] [clean:clean][INFO] Deleting directory C:\local\project\target[INFO] Deleting directory C:\local\project\target\classes[INFO] Deleting directory C:\local\project\target\test-classes[INFO] Deleting directory C:\local\project\target\site[INFO] [javancss:report {execution: default}][WARNING] Unable to locate Source XRef to link to - DISABLED[INFO] [resources:resources][INFO] Using default encoding to copy filtered resources.[INFO] [compiler:compile][INFO] Compiling 1 source files to C:\local\project\target\classes[INFO] [resources:testResources][INFO] Using default encoding to copy filtered resources.[INFO] [compiler:testCompile][INFO] Nothing to compile - all classes are up to date[INFO] [surefire:test][INFO] No tests to run.[INFO] [jar:jar][INFO] Building jar: C:\local\project\target\SimpleM2Project-1.0-SNAPSHOT.jar[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] BUILD SUCCESSFUL[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] Total time: 5 seconds[INFO] Finished at: Sun Jan 13 22:06:20 GMT 2008[INFO] Final Memory: 5M/10M[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;And there should be a javancss-raw-report.xml file in the target directory.The Maven2 based multi-module projectWe can generate this project in its simplest form just by adding the simple project as a child of a project with pom. We‚Äôll start off with the following directory structure:project/ SimpleM2Project pom.xml src/ main/ java/ com/ onedash/ hello/ Hello.java test/ java/Where the SimpleM2Project subtree is a copy of the previous project. All we now need is a pom.xml to nest this project in: 4.0.0 com.onedash.mvn.hudson MultiM2Project MultiM2Project 1.0-SNAPSHOT pom SimpleM2Project And running maven should give the following output:C:\local\project>mvn clean package[INFO] Scanning for projects&mldr;[INFO] Reactor build order:[INFO] SimpleM2Project[INFO] MultiM2Project[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] Building SimpleM2Project[INFO] task-segment: [clean, package][INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] [clean:clean][INFO] Deleting directory C:\local\project\SimpleM2Project\target[INFO] Deleting directory C:\local\project\SimpleM2Project\target\classes[INFO] Deleting directory C:\local\project\SimpleM2Project\target\test-classes[INFO] Deleting directory C:\local\project\SimpleM2Project\target\site[INFO] [javancss:report {execution: default}][WARNING] Unable to locate Source XRef to link to - DISABLED[INFO] [resources:resources][INFO] Using default encoding to copy filtered resources.[INFO] [compiler:compile][INFO] Compiling 1 source files to C:\local\project\SimpleM2Project\target\classes[INFO] [resources:testResources][INFO] Using default encoding to copy filtered resources.[INFO] [compiler:testCompile][INFO] No sources to compile[INFO] [surefire:test][INFO] No tests to run.[INFO] [jar:jar][INFO] Building jar: C:\local\project\SimpleM2Project\target\SimpleM2Project-1.0-SNAPSHOT.jar[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] Building MultiM2Project[INFO] task-segment: [clean, package][INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] [clean:clean][INFO] Deleting directory C:\local\project\target[INFO] Deleting directory C:\local\project\target\classes[INFO] Deleting directory C:\local\project\target\test-classes[INFO] Deleting directory C:\local\project\target\site[INFO] [site:attach-descriptor][INFO][INFO][INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] Reactor Summary:[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] SimpleM2Project &mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr; SUCCESS [7.240s][INFO] MultiM2Project &mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;&mldr;. SUCCESS [2.754s][INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] BUILD SUCCESSFUL[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] Total time: 10 seconds[INFO] Finished at: Sun Jan 13 22:16:37 GMT 2008[INFO] Final Memory: 7M/15M[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;And there should be a javancss-raw-report.xml file in the SimpleM2Project/target directory.The Hudson setupWe‚Äôll start by running mvn hpi:create to create a base to work from:C:\local>mvn hpi:create[INFO] Scanning for projects&mldr;[INFO] Searching repository for plugin with prefix: &lsquo;hpi&rsquo;.[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] Building Maven Default Project[INFO] task-segment: [hpi:create] (aggregator-style)[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-&mldr;[INFO] [hpi:create]Enter the groupId of your plugin: org.jvnet.hudson.plugins[INFO] Defaulting package to group ID: org.jvnet.hudson.pluginsEnter the artifactId of your plugin: javancss&mldr;[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] BUILD SUCCESSFUL[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;[INFO] Total time: 2 minutes 44 seconds[INFO] Finished at: Sun Jan 13 22:34:58 GMT 2008[INFO] Final Memory: 8M/15M[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;The result should be a sub-directory called javancss with a pom.xml file and a basic Hudson plugin starting point. We‚Äôll edit the pom.xml to update the version of Hudson to the latest (at the time of writing 1.170) and launch a live development instance to set our projects up in.Open up the pom.xml file, and change the 1.153 tags for the hudson-core and hudson-war dependencies to 1.170.The dependency section should now look like this: org.jvnet.hudson.main hudson-core 1.170 provided org.jvnet.hudson.main hudson-war war 1.170 testNext launch a copy of Hudson by running mvn hpi:runC:\local\javancss>mvn hpi:run[INFO] Scanning for projects&mldr;[INFO] Searching repository for plugin with prefix: &lsquo;hpi&rsquo;.[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] Building Unnamed - org.jvnet.hudson.plugins:javancss:hpi:1.0-SNAPSHOT[INFO] task-segment: [hpi:run][INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-[INFO] Preparing hpi:run&mldr;[INFO] Started Jetty Server[INFO] Starting scanner at interval of 1 seconds.Now fire up a web browser for http://localhost:8080/We want to create five projects: Freestyle project for the Simple Ant projectFreestyle project for the Single module Maven2 projectFreestyle project for the Multi-module Maven2 projectMaven2 project for the Single module Maven2 projectMaven2 project for the Multi-module Maven2 projectFor extra finesse, we can add a slave executor, and create a second set of these projects tied to the slave. An final extra project that does nothing other than trigger all the other projects to build is the icing on the cake.</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Sun, 13 Jan 2008 00:00:00 +0000" class=no-wrap title=" Sun, 13 Jan 2008 00:00:00 +0000">Sun, 13 Jan 2008 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2008-01-01-writing-a-hudson-plug-in-part-2-understanding-m2-and-freestyle-projects/>Writing a Hudson plug-in (Part 2 ‚Äì Understanding m2 and freestyle projects)</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>Before we proceed with developing the plugin, there is an important concept to understand: How the different project types invoke their plugins.Currently, one of the biggest source of confusion for end users of Hudson is that most of the plugins do not work with the &ldquo;m2 project type&rdquo;. This is because there are essentially two completely different implementations of plugins.&ldquo;Normal&rdquo; Plugins"Normal" plugins work with all project types except the &ldquo;m2 project type&rdquo;. Typically they will extend Publisher. The model of execution is that the Publisher is invoked on the Hudson Master and can invoke actions remotely on the slave.The plugin author must be mindfull that they do not overload the master with excessive work, either by minimising the amount of work to be performed, or by sending work to the slave for execution. Best performance will be achieved if the heavy lifting is performed on the slave and then finally the results are sent to the master. Multiple trips back and forth between the master and the slave will not be performant.&ldquo;Maven&rdquo; Plugins"Maven" plugins only work with the &ldquo;m2 project type&rdquo;. They must extend MavenReporter. Contrary to the &ldquo;Normal&rdquo; plugins, they are executed on the Slave. This is because they are invoked as call-backs from the Maven Embedded that is running on the slave. If the MavenReporter is able to invoke actions remotely on the Master.The plugin author does not have to be as mindful about overloading the master, as by default, they are executing on the slave, however, the side effect is that the plugin does not have full access to all the Hudson objects, and must usually send work to the master, e.g. to add an Action to a build, it is necessary to serialize the Action, send it to the master along with a Callable that then takes the deserialized Action and adds it to the real Build. (Note: Adding an action is such a common task that BuildProxy provides convenience methods to do this for us)Don&rsquo;t Repeat YourselfThe result of this split is that it can be difficult to keep the DRY principles when developing Hudson plugins. Looking at what all plugins do, though, there is a standard pattern for most Publishing plugins:Determine where the information to be published is to be foundProcess/extract the information on the slaveSend the persistent result of the build to the masterFinalize processing of the information on the masterStrictly speaking only one of the last two steps is required, however, in most cases there is a trade-off between tasks that are more performant when executed on the slave and tasks that must be performed on the master as either the required information is not available on the slave or the activity will affect the object instances on the master as an artifact of the serialization call-by-value that occurs on the slave.Thus to keep the DRY principles we need to:Publisher or MavenReporter constructs a Configuration object.If the Configuration requires tasks to execute on the slave, ensure that it is sent to the slave and execute those tasks on the slave.If the Configuration requires tasks to execute on the master, send it (if necessary back) to the master and execute those tasks on the master.There are other issues with respect to Actions, i.e. Actions for a &ldquo;m2 project type&rdquo; must extend a specific subclass. However, this is not a problem, as there is nothing to stop us just having all the actions extend this type, the non-&ldquo;m2 project type&rdquo; usage will just ignore that it&rsquo;s extending the subclass.What&rsquo;s nextIn part 3, I will present a couple of wrapper classes that we can use to ensure that the DRY principle gives us plugin execution in one place. Part 4 will tie these wrapper classes into the Hudson plugin framework, giving us a MavenReporter and a Publisher that both use common code to deliver the plugin functionality. Part 5 will add aggregated reporting for m2 project. Part 6 will add simple trend graphs. Part 7 will close out by actually parsing the JavaNCSS files and implementing our plugin!</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Tue, 01 Jan 2008 00:00:00 +0000" class=no-wrap title=" Tue, 01 Jan 2008 00:00:00 +0000">Tue, 01 Jan 2008 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2007-12-14-jpa-equals-and-hashcode/>JPA, equals() and hashCode()</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p><a href="http://burtbeckwith.com/blog/?p=53">http://burtbeckwith.com/blog/?p=53</a></p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/java><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Java
</a><a class="muted-link mr-3" href=/tags/javaee><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
JavaEE
</a>Created
<relative-time datetime="Fri, 14 Dec 2007 00:00:00 +0000" class=no-wrap title=" Fri, 14 Dec 2007 00:00:00 +0000">Fri, 14 Dec 2007 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2007-11-21-combining-hibernate-and-facelets-with-maven-netbeans-and-glassfish/>Combining Hibernate and Facelets with Maven, Netbeans and Glassfish</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>Note to self, for later reading</p><p><a href="http://technology.amis.nl/blog/?p=2610">http://technology.amis.nl/blog/?p=2610</a></p><p>Not sure why netbeans is essential on this!</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/java><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Java
</a><a class="muted-link mr-3" href=/tags/maven><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Maven
</a><a class="muted-link mr-3" href=/tags/javaee><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
JavaEE
</a>Created
<relative-time datetime="Wed, 21 Nov 2007 00:00:00 +0000" class=no-wrap title=" Wed, 21 Nov 2007 00:00:00 +0000">Wed, 21 Nov 2007 00:00:00 +0000</relative-time></div></div></li><li class="col-12 d-flex width-full py-4 border-bottom color-border-secondary public source"><div class="col-12 d-inline-block"><div class="d-inline-block mb-1"><h3 class=wb-break-all><a href=https://stephenc.github.io/post/2007-11-14-sventon-and-hudson/>Sventon and Hudson</a></h3></div><div><div class="col-12 d-inline-block text-gray mb-2 pr-4"><p>This morning I discovered sventon (<a href=http://www.sventon.org>http://www.sventon.org</a>) a Subversion (<a href=http://subversion.tigris.org/>http://subversion.tigris.org/</a>) repository browser written in Java. And it&rsquo;s free! Ten minutes later I had this integrated as a Repository browser in Hudson (<a href=https://hudson.dev.java.net/>https://hudson.dev.java.net/</a> will be available in build 1.157) and I&rsquo;m loving it. It&rsquo;s not quite as good as fisheye&mldr; but it does everything I need it to!</p><p>Hudson is <em>really</em> starting to have kick-ass features that leave everything else for dust.</p></div></div><div class="f6 text-gray mt-2"><a class="muted-link mr-3" href=/tags/jenkins><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
Jenkins
</a>Created
<relative-time datetime="Wed, 14 Nov 2007 00:00:00 +0000" class=no-wrap title=" Wed, 14 Nov 2007 00:00:00 +0000">Wed, 14 Nov 2007 00:00:00 +0000</relative-time></div></div></li></ul><div class=paginate-container><div class=BtnGroup><a rel=nofollow class="btn btn-outline BtnGroup-item" href=/post/page/4/>Previous</a>
<a rel=nofollow class="btn btn-outline BtnGroup-item" href=/post/page/6/>Next</a></div></div></div></div></div></div></div></div><script>window.onscroll=function(){const n=document.querySelector("#headerImg"),t=document.querySelector("#headerStuck");n.getBoundingClientRect().bottom<=0?(t.classList.add("is-stuck"),window.innerWidth>=1280?t.setAttribute("style","top: 12px;"):t.setAttribute("style","top: 0;")):t.classList.remove("is-stuck")};var style=localStorage.getItem("data-color-mode");githubIconElement=document.getElementById("github-icon"),twitterIconElement=document.getElementById("twitter-icon"),style=="light"?(githubIconElement&&githubIconElement.setAttribute("fill","#24292e"),twitterIconElement&&twitterIconElement.setAttribute("fill","black")):(githubIconElement&&(githubIconElement.removeAttribute("fill"),githubIconElement.setAttribute("class","octicon"),githubIconElement.setAttribute("color","#f0f6fc")),twitterIconElement&&twitterIconElement.setAttribute("fill","white"))</script></div><footer style="text-align:center;padding:20px;border-top:1px solid #eee;margin-top:40px"><p style=margin:0;color:#666;font-size:14px>¬© 2025 Stephen Connolly
| <a href=# onclick="return resetCookieConsent(),!1" style=color:#666;text-decoration:underline>Cookie Settings</a></p></footer><div id=cookie-consent-banner style="display:none;position:fixed;bottom:0;left:0;right:0;background:#333;color:#fff;padding:15px;text-align:center;z-index:9999;box-shadow:0 -2px 10px rgba(0,0,0,.3)"><div style="max-width:1200px;margin:0 auto"><p style="margin:0 0 10px;font-size:14px">This website uses Google Analytics to help analyze how visitors use this site. By continuing to browse this site, you agree to this use.
<a href=# style=color:#4caf50;text-decoration:underline onclick="return showCookieDetails(),!1">Learn more</a></p><div><button onclick=acceptCookies() style="background:#4caf50;color:#fff;border:none;padding:8px 16px;margin:0 5px;cursor:pointer;border-radius:4px">Accept</button>
<button onclick=declineCookies() style="background:#f44336;color:#fff;border:none;padding:8px 16px;margin:0 5px;cursor:pointer;border-radius:4px">Decline</button></div></div></div><div id=cookie-details-modal style=display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:10000><div style=position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:20px;border-radius:8px;max-width:500px;width:90%><h3 style=margin-top:0>Cookie Information</h3><p>This website uses Google Analytics, which uses cookies to collect anonymous information about how visitors use this site. This information is used to improve the website experience.</p><p><strong>What data is collected:</strong></p><ul><li>Pages visited and time spent on pages</li><li>How you arrived at the site</li><li>General location (country/city level)</li><li>Device and browser information</li></ul><p>No personally identifiable information is collected. You can opt out at any time by declining cookies.</p><button onclick=hideCookieDetails() style="background:#2196f3;color:#fff;border:none;padding:8px 16px;cursor:pointer;border-radius:4px">Close</button></div></div><script>function getCookieConsent(){return localStorage.getItem("cookieConsent")}function setCookieConsent(e){localStorage.setItem("cookieConsent",e)}function loadGoogleAnalytics(){var t,e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-CEQZZXVE7Q",document.head.appendChild(e),t=document.createElement("script"),t.innerHTML=`
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CEQZZXVE7Q', {
        anonymize_ip: true,
        cookie_flags: 'SameSite=None;Secure'
      });
    `,document.head.appendChild(t)}function acceptCookies(){setCookieConsent("accepted"),document.getElementById("cookie-consent-banner").style.display="none",loadGoogleAnalytics()}function declineCookies(){setCookieConsent("declined"),document.getElementById("cookie-consent-banner").style.display="none"}function showCookieDetails(){document.getElementById("cookie-details-modal").style.display="block"}function hideCookieDetails(){document.getElementById("cookie-details-modal").style.display="none"}function resetCookieConsent(){localStorage.removeItem("cookieConsent"),document.getElementById("cookie-consent-banner").style.display="block"}document.addEventListener("DOMContentLoaded",function(){var e=getCookieConsent();e==="accepted"?loadGoogleAnalytics():e==="declined"||(document.getElementById("cookie-consent-banner").style.display="block")})</script></body><script type=application/javascript src=https://stephenc.github.io/js/github-style.js></script><script src=https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js></script><script type=application/javascript src=https://stephenc.github.io/js/search.js></script></html>